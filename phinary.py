# phi.py
import math
import re


def base_eval(base, pos_pow_str="0.0", neg_pow_str="0.0"):
    '''Takes in a base and two strings. Evaluates the polynomial using the string as coeffs
        e.g. base = b, pos_pow_str = "110.01", neg_pow_str = 1.1"
        total = b^2 + b^1 + b^-2 - b^0 - b^-1
        
        @return: The decimal number evaluation

    '''
    # Remove "_" characters
    pos_pow_str = re.sub('[_]', '', pos_pow_str)
    neg_pow_str = re.sub('[_]', '', neg_pow_str)
    total = 0
    if not pos_pow_str.count("."): pos_pow_str += ".0"
    if not neg_pow_str.count("."): neg_pow_str += ".0"

    pos_pow_split = pos_pow_str.split(".")
    for pow, val in enumerate(pos_pow_split[0][::-1]):
        if '_' in val: continue
        total += int(val)*base**(int(pow))
    for pow, val in enumerate(pos_pow_split[1], start=1):
        if '_' in val: continue
        total += int(val)*base**(int(-pow))

    neg_pow_split = neg_pow_str.split(".")
    for pow, val in enumerate(neg_pow_split[0][::-1]):
        if '_' in val: continue
        total -= int(val)*base**(int(pow))
    for pow, val in enumerate(neg_pow_split[1], start=1):
        if '_' in val: continue
        total -= int(val)*base**(int(-pow))
    
    print_len = 16
    print(f"base {base:.3f}\t{' '*(print_len-len(pos_pow_str))}{pos_pow_str} - {' '*(print_len-len(neg_pow_str))}{neg_pow_str} = {total:.3f}\tbase 10")
    
    return total

if __name__ == "__main__":
    phi = (1 + math.sqrt(5)) / 2

    #base_eval(phi, "11010100.010011", "1010.1011101")
    #base_eval(phi, "110101.0101", "1000.101")
    #base_eval(phi, '11120201.020001', '2010.2020001')
    #base_eval(phi, '11120201.020001', '10020.1121101')
    #base_eval(phi, '11120201.020001', '10020.2011101')
    #base_eval(phi, '11120202.030001', '10111.1011101')
    #base_eval(phi, '1.', '.0')
    #base_eval(phi, '11.', '.1')
    #base_eval(phi, '111.', '.111')
    #base_eval(phi, '1111.', '.11111')
    #base_eval(phi, '11111.1', '0.0111111')
    #base_eval(phi, '11111.000', '0.0001111')
    #base_eval(phi, '1011101.000', '0.0101101')
    #base_eval(phi, '01111011.0001010000', '11.00101')
    #base_eval(phi, '11111010.1011111111', '00.00000')
    #base_eval(phi, '111101010.1101010100', '00.000010100')
    #base_eval(phi, '0111101011.0001000000', '00.000000101')
    #base_eval(phi, '01010001011.0001000000', '00.000000101')
    #base_eval(phi, '10110111011.0001110100', '00.00000110111')
    #base_eval(phi, '111010101111.0011000101', '00.00000000101')
    #base_eval(phi, '10101110110111.0111000101', '00.0000000000101')
    #base_eval(phi, '110110111010101.11111111001111', '00.000000001010111')
    #base_eval(phi, '10101010111111011.0111070101011011', '10000001.01110111101011111')

    
    #base_eval(phi, '1011101.000', '0.0101101')
    #base_eval(phi, '11101101.000', '1.011110111')
    #base_eval(phi, '1010111100.000', '1.10001111111')
    #base_eval(phi, '11011010101.000', '0.01000011101')
    #base_eval(phi, '111111110101.000', '0.1111101010111')
    #base_eval(phi, '10111111010111.000', '0.101011101100111')
    #base_eval(phi, '111110001110111.000', '0.101110001110101')
    #base_eval(phi, '11001010101011110.0000', '0.00010101011010001')
    #base_eval(phi, '111011010101101110.0000', '0.0011010101101110111')
    #base_eval(phi, '10101111110110101010.0000', '0.011111011010101111111')
    #base_eval(phi, '110111011011110202011.0000', '0.110101111110111100101')
    #base_eval(phi, '110111011011111101000.0000', '0.110101111110111100101')
    #base_eval(phi, '11000000110001000101100.0000', '0.10100110100000100000001')
    #base_eval(phi, '111000001110001111101010.0000', '0.1010010000100100100000111')
    #base_eval(phi, '10101000101010101110111000.0000', '0.101111110011111111100111111')
    #base_eval(phi, '110100011101010110110111100.0000', '0.011011011011111110110111101')
    #base_eval(phi, '1111100000010000100000000010.0000', '0.01011000000011110101011010111')
    #base_eval(phi, '1001001110100101001001010101.0000', '0.10111011010101101101011011010')
    #base_eval(phi, '11101101110110101101001010110.0000', '0.01101011011101010111011111011')

    #base_eval(phi, '11.0', '0.1')
    #base_eval(phi, '.1', '11.000')
    #base_eval(phi, '12101.', '2.100')
    #base_eval(phi, '11.', '0.1')
    #base_eval(phi, '12.', '0.1')
    #base_eval(phi, '120.', '1.0')
    #base_eval(phi, '1.0','120.')

    #base_eval(phi, '6.0','000.')
    #base_eval(phi, '103.01','0000.')
    #base_eval(phi, '211.01','0010.1')
    #base_eval(phi, '1101.01','010.1')
    #base_eval(phi, '10.1011','1.01')

    #base_eval(phi, '1010010111011010101111.','1101110110010110101100.')
    #base_eval(phi,  '00_0000_0001_0000_1000_0100.', \
    #                '01_0000_0000_0000_0000_0000.')
    #            
    #base_eval(phi,  '01_0111_1011_1001_1100_0100.', \
    #                '00_1000_0100_0110_0010_0000.')
    #base_eval(phi,  '01_0010_0000_0010_0100_0100.',  '00_0000_0000_0000_0010_0000.')
    #base_eval(phi,  '00_0000_0001_0000_1000_0100.',  '01_0000_0000_0000_0000_0000.')
    #base_eval(phi,  '01_0010_0001_0010_1100_0111.',  '01_0000_0000_0000_0010_0000.')

    #base_eval(phi,'01_0101_0000.0001_0101', '0000_0000.0000_0000_0000')

    #base_eval(phi,'0010_0000_0000.0010_0000', '0000_1000.0000_0000_1000')
    #base_eval(phi,'0100_1000_0000.0100_1000', '0001_0010.0000_0001_0010')
    #base_eval(phi,'1000_1000_0000.1000_1000', '0010_0010.0000_0010_0010')
    #base_eval(phi,'0100_0100_0000_1001.0000_0000_1000', '0010_0000_0100_0000.0010_0100_0000_1000')
    #base_eval(phi,'0000_1000_1000_0000.1000_1000_0000', '0000_0000_0010_0010.0000_0010_0010_0000')
    #base_eval(phi,'0100_1100_1000_1001.1000_1000_1000', '0010_0000_0110_0010.0010_0110_0010_1000')
    #base_eval(phi,'1000_0100_0000_1000.0000_0000_0100', '0100_0000_0000_0000.0010_0000_0000_1000')
    #base_eval(phi,'0010_0100_1001_0010_0100_1001_0010_0100_0100100100100100.', '0')
    #base_eval(phi,'001_001_001_001_001_001_001_001_001_001_001_.', '0')

    #base_eval(phi,'002_002_002_002_002_002_002_002_002_002_002_.', '0')
    ##base_eval(phi,'010_101_010_101_010_101_010_101_010_101_010.01', '0')
    ##base_eval(phi,'1010_1010_1010_1010_1010_1010_1010_1010.01', '0')

    #base_eval(phi,'100_100_100_100_100_100_100_100_100_100_100.', \
    #              '000_100_100_100_100_100_100_100_100_100_100.1')
    #base_eval(phi,'100_000_000_000_000_000_000_000_000_000_000.', \
    #              '000_000_000_000_000_000_000_000_000_000_000.1')
    #base_eval(phi,'002_002.', '0')
    #base_eval(phi,'100_100.', '100.1')
    #base_eval(phi,'002_002_002.', '0')
    #base_eval(phi,'100_100_100.', '100_100.1')

    #base_eval(phi,'002.', '0')
    #base_eval(phi,'010.01', '0')
    #base_eval(phi,'100.', '0.1')
    base_eval(phi,'1000_1000_1000_1000_0100_0100_0100_0100.0000', '0')
    base_eval(phi,'1000_0100_0010_0001_1000_0100_0010_0001.0000', '0')
    base_eval(phi,'0000_2000_1100_1010_1001_1100_0200_0110_0101.0000', \
                  '0000_0000_0000_0000_0000_0000_0000_0000_0000.0000')
    base_eval(phi,'0100_0100_0010_0000_0000_0001_0000_0001_0001.0000', '0010_0000_0000_1000_0000_1000_0001_0000_1000.0000')
    base_eval(phi,'0200_0200_0020_0000_0000_0002_0000_0002_0002.0000', '0020_0000_0000_2000_0000_2000_0002_0000_2000.0000')
    base_eval(phi,'1000_0100_0100_0000_0000_0000_0001_0001_0000.0100', '0010_0010_0000_1000_0001_0000_0000_0100_0000.0000')
    base_eval(phi,'0100_0100_0010_0000_1000_1000_1000_1000_0010.0000', '0001_0000_0001_0000_0001_0001_0001_0000_1000.0010')
    base_eval(phi,'1100_0200_0110_0000_1000_1000_1001_1001_0010.0100', '0011_0010_0001_1000_0002_0001_0001_0100_1000.0010')
    base_eval(phi,'1000_1000_0000_0000_1000_0010_0000_0100_0010.0001', '0000_0000_0010_0000_0010_0000_0100_0000_1000.0000')
    base_eval(phi,'0010_0010_0001_0001_0000_0010_0001_0001_0000.1000', '0000_1000_0001_0001_0000_1000_0100_0100_0010.0010')
    base_eval(phi,'1010_1010_0001_0001_1000_0020_0001_0101_0010.1001', '0000_1000_0011_0001_0010_1000_0200_0100_1010.0010')

    # Clean up all 011 to 100 and 0200 to 1001
    base_eval(phi,'1010_0010_0000_0000_1000_0100_1001_0001_0000.1001', \
                  '0000_0000_0010_0000_0010_1000_1001_0000_1000.0010')
    # Cancel phi+ and phi-
    base_eval(phi,'1010_0010_0000_0000_1000_0100_0000_0001_0000.1001', \
                  '0000_0000_0010_0000_0010_1000_0000_0000_1000.0010')
    base_eval(phi,'0001_0000_0010_0000_0000_0100_0100_0000_0001_0000.1000_1100', \
                  '0000_0001_0000_0010_0000_0000_1000_0000_0000_1000.0010_0000')

    
    

    #base_eval(2, '10.1')
    #base_eval(2, '0.01101')
    